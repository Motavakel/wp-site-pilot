### WP Site Pilot Plugin

![Plugin Version](https://img.shields.io/badge/version-1.2.1-blue)
[![WordPress compatible](https://img.shields.io/badge/WordPress-6.8-brightgreen.svg)](https://wordpress.org/)

افزونه‌ای برای مدیریت وردپرس از طریق REST API

## قابلیت‌ها

- به‌روزرسانی هسته وردپرس به‌صورت امن با مدیریت خطا برای جلوگیری از کرش سایت
- مانیتورینگ سایت شامل اطلاعات بخش سلامت سیستم (Site Health)
- تهیه بک‌آپ از پایگاه داده به‌صورت فایل با پسوند `.sql`
- سیستم احراز هویت JWT شامل Access Token و Refresh Token

<br>

## احراز هویت و مدیریت توکن‌ها (Authentication & Token Management)

برای استفاده از درخواست‌های REST API افزونه، ابتدا باید پروسه احراز هویت انجام شود و توکن‌های لازم را دریافت کند. روند کار به شرح زیر است:

#### 1. لاگین (Login)

 ابتدا باید یک درخواست **POST** به مسیر زیر با پارامتر های ورودی ارسال شود:

```bash
../wp-json/ddbs/v1/login
```

#### پارامترهای ورودی (Request Body):

- `username` : نام کاربری
- `password` : رمز عبور

#### پاسخ موفق (HTTP 200 OK):

```json
{
  "message": "ورود با موفقیت انجام شد",
  "access_token": "...",
  "refresh_token": "..."
}
```

#### 2. ارسال درخواست‌های بعدی

برای ارسال درخواست‌های بعدی به API، باید توکن دسترسی (access_token) را در هدر درخواست ارسال شود:

```bash
Authorization: Bearer access_token
```

#### 3. تمدید توکن دسترسی (Refresh Token)

اگر توکن دسترسی منقضی شده باشد، API پاسخ با کد وضعیت 401 Unauthorized خواهد داد.

در این صورت باید درخواست را با ارسال هدر زیر مجدداً ارسال شود:

```bash
x-refresh-token: ...
```

#### 4. دریافت اکسس توکن جدید

در صورتی که رفرش توکن صحیح باشد و مشکلی نداشته باشد، ضمن انجام درخواست مدنظر اکسس توکن جدید تولید و با نام زیر در هدر پاسخ قرار می گیرذ

```bash
x-access-token: ...
```

<br>

## آپدیت هسته وردپرس (WordPress Core Update)

برای آپدیت هسته وردپرس بایستی یک درخواست **POST** به مسیر زیر ارسال شود:

```bash
../wp-json/ddbs/v1/update-core
```

<br>

## دریافت بک آپ دیتابیس(Database Backup)

برای دریافت بک آپ از دیتابیس بایستی یک درخواست **GET** به مسیر زیر ارسال شود:

```bash
../wp-json/ddbs/v1/backup
```


<br>

## دریافت اطلاعات سلامت سایت(Site Health)

برای دریافت اطلاعات سلامت سایت بایستی یک درخواست **GET** به مسیر زیر ارسال شود:

```bash
../wp-json/ddbs/v1/health
```
<br>

## کتابخانه‌ی استفاده‌شده

در این افزونه از کتابخانه‌ی زیر استفاده شده است:

- [firebase/php-jwt](https://github.com/firebase/php-jwt)

این پکیج توسط تیم توسعه‌ی گوگل ارائه شده و برای رمزنگاری (encode) و رمزگشایی (decode) توکن‌های JWT با دقت و امنیت بالا استفاده می‌شود.

نصب این پکیج از طریق Composer و با اجرای دستور زیر در ریشه افزونه انجام شده است:

```bash
composer require firebase/php-jwt
```

<br>

## تغییرات نسخه (Changelog)

### نسخه 1.0.1

- افزودن قابلیت به‌روزرسانی امن هسته وردپرس با مدیریت خطا
- اضافه کردن مانیتورینگ سایت شامل اطلاعات سلامت سیستم (Site Health)
- امکان تهیه بک‌آپ از پایگاه داده به صورت فایل `.sql`

### نسخه 1.2.1

- اضافه کردن سیستم احراز هویت JWT با استفاده از Access Token و Refresh Token
